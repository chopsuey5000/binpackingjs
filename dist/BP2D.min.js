!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("BinPacking",[],e):"object"==typeof exports?exports.BinPacking=e():t.BinPacking=e()}(this,(function(){return function(){var t={23:function(t){var e=function(){"use strict";function t(e,n,i,o){"object"==typeof n&&(i=n.depth,o=n.prototype,n.filter,n=n.circular);var s=[],c=[],h="undefined"!=typeof Buffer;return void 0===n&&(n=!0),void 0===i&&(i=1/0),function e(i,a){if(null===i)return null;if(0==a)return i;var u,l;if("object"!=typeof i)return i;if(t.__isArray(i))u=[];else if(t.__isRegExp(i))u=new RegExp(i.source,r(i)),i.lastIndex&&(u.lastIndex=i.lastIndex);else if(t.__isDate(i))u=new Date(i.getTime());else{if(h&&Buffer.isBuffer(i))return u=Buffer.allocUnsafe?Buffer.allocUnsafe(i.length):new Buffer(i.length),i.copy(u),u;void 0===o?(l=Object.getPrototypeOf(i),u=Object.create(l)):(u=Object.create(o),l=o)}if(n){var f=s.indexOf(i);if(-1!=f)return c[f];s.push(i),c.push(u)}for(var p in i){var g;l&&(g=Object.getOwnPropertyDescriptor(l,p)),g&&null==g.set||(u[p]=e(i[p],a-1))}return u}(e,i)}function e(t){return Object.prototype.toString.call(t)}function r(t){var e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),e}return t.clonePrototype=function(t){if(null===t)return null;var e=function(){};return e.prototype=t,new e},t.__objToStr=e,t.__isDate=function(t){return"object"==typeof t&&"[object Date]"===e(t)},t.__isArray=function(t){return"object"==typeof t&&"[object Array]"===e(t)},t.__isRegExp=function(t){return"object"==typeof t&&"[object RegExp]"===e(t)},t.__getRegExpFlags=r,t}();t.exports&&(t.exports=e)},426:function(t,e,r){!function(){"use strict";!function(){if("undefined"==typeof console)throw new Error("Weird, console object is undefined");if("function"!=typeof console.table||console.table!==f){var e=function(t,e){return typeof e===t}.bind(null,"string"),n=s.bind(null,e),i=s.bind(null,Array.isArray),o=r(185);t.exports.getTable=function(){var t=Array.prototype.slice.call(arguments),e="";return 2===t.length&&"string"==typeof t[0]&&Array.isArray(t[1])?u(t[0],t[1]):2===t.length&&n(t[0])&&i(t[1])?h(t[0],t[1],!0):(t.forEach((function(r,n){if("string"==typeof r)return e+=r,void(n!==t.length-1&&(e+="\n"));Array.isArray(r)?e+=c(r)+"\n":"object"==typeof r&&(e+=l(r))})),e)},console.table=f}function s(t,e){return Array.isArray(e)&&e.every(t)}function c(t){var e=new o;return t.forEach((function(t){"string"==typeof t||"number"==typeof t?e.cell("item",t):Object.keys(t).forEach((function(r){e.cell(r,t[r])})),e.newRow()})),e.toString()}function h(t,e,r){var n=new o;e.forEach((function(e){e.forEach((function(e,r){n.cell(t[r],e)})),n.newRow()}));var i=n.toString();return r?i:console.log(i)}function a(t,e){var r=c(e),n=r.indexOf("\n");if(n>0){t.length>n&&(n=t.length),console.log(t);var i,o="";for(i=0;i<n;i+=1)o+="-";console.log(o)}console.log(r)}function u(t,e){var r=c(e),n=r.indexOf("\n"),i="";if(n>0){t.length>n&&(n=t.length),i+=t+"\n";var o,s="";for(o=0;o<n;o+=1)s+="-";i+=s+"\n"}return i+r}function l(t){return c(function(t){return Object.keys(t).map((function(e){return{key:e,value:t[e]}}))}(t))}function f(){var t=Array.prototype.slice.call(arguments);return 2===t.length&&"string"==typeof t[0]&&Array.isArray(t[1])?a(t[0],t[1]):2===t.length&&n(t[0])&&i(t[1])?h(t[0],t[1]):void t.forEach((function(t){if("string"==typeof t)return console.log(t);Array.isArray(t)?console.log(c(t)):"object"==typeof t&&console.log(l(t))}))}}()}()},451:function(t,e,r){var n=r(23);t.exports=function(t,e){return t=t||{},Object.keys(e).forEach((function(r){void 0===t[r]&&(t[r]=n(e[r]))})),t}},185:function(t,e,r){var n;try{n=r(561)}catch(t){}function i(){this.rows=[],this.row={__printers:{}}}function o(t){return void 0===t?"":""+t}function s(t){var e=t.replace(/\u001b\[\d+m/g,"");return null==n?e.length:n(e)}function c(t){return function(e,r){var n=o(e),i=s(n);return(r>i?Array(r-i+1).join(t):"")+n}}t.exports=i,i.prototype.newRow=function(){return this.rows.push(this.row),this.row={__printers:{}},this},i.prototype.cell=function(t,e,r){return this.row[t]=e,this.row.__printers[t]=r||o,this},i.prototype.separator="  ",i.string=o,i.leftPadder=c;var h=i.padLeft=c(" ");function a(t){return function(e,r){var n=o(e),i=s(n);return n+(r>i?Array(r-i+1).join(t):"")}}i.rightPadder=a;var u=a(" ");function l(t,e){for(var r in t)"__printers"!=r&&e(r,t[r])}function f(t,e){return t===e?0:void 0===t?1:void 0===e?-1:null===t?1:null===e?-1:t>e?1:t<e?-1:f(String(t),String(e))}i.number=function(t){return function(e,r){if(null==e)return"";if("number"!=typeof e)throw new Error(e+" is not a number");var n=null==t?e+"":e.toFixed(t);return h(n,r)}},i.prototype.columns=function(){for(var t={},e=0;e<2;e++)this.rows.forEach((function(e){var r=0;l(e,(function(e){r=Math.max(r,t[e]||0),t[e]=r,r++}))}));return Object.keys(t).sort((function(e,r){return t[e]-t[r]}))},i.prototype.print=function(){var t=this.columns(),e=this.separator,r={},n="";return this.rows.forEach((function(t){l(t,(function(e,n){var i=t.__printers[e].call(t,n);r[e]=Math.max(s(i),r[e]||0)}))})),this.rows.forEach((function(i){var o="";t.forEach((function(t){var n=r[t],s=i.hasOwnProperty(t)?""+i.__printers[t].call(i,i[t],n):"";o+=u(s,n)+e})),o=o.slice(0,-e.length),n+=o+"\n"})),n},i.prototype.toString=function(){var t=this.columns(),e=new i;return e.separator=this.separator,t.forEach((function(t){e.cell(t,t)})),e.newRow(),e.pushDelimeter(t),e.rows=e.rows.concat(this.rows),this.totals&&this.rows.length&&(e.pushDelimeter(t),this.forEachTotal(e.cell.bind(e)),e.newRow()),e.print()},i.prototype.pushDelimeter=function(t){return(t=t||this.columns()).forEach((function(t){this.cell(t,void 0,c("-"))}),this),this.newRow()},i.prototype.forEachTotal=function(t){for(var e in this.totals){var r=this.totals[e],n=r.init,i=this.rows.length;this.rows.forEach((function(t,o){n=r.reduce.call(t,n,t[e],o,i)})),t(e,n,r.printer)}},i.prototype.printTransposed=function(t){t=t||{};var e=new i;return e.separator=t.separator||this.separator,this.columns().forEach((function(r){e.cell(0,r,t.namePrinter),this.rows.forEach((function(t,n){e.cell(n+1,t[r],t.__printers[r])})),e.newRow()}),this),e.print()},i.prototype.sort=function(t){if("function"==typeof t)return this.rows.sort(t),this;var e=(Array.isArray(t)?t:this.columns()).map((function(t){var e="asc",r=/(.*)\|\s*(asc|des)\s*$/.exec(t);return r&&(t=r[1],e=r[2]),function(r,n){return"asc"==e?f(r[t],n[t]):f(n[t],r[t])}}));return this.sort((function(t,r){for(var n=0;n<e.length;n++){var i=e[n](t,r);if(0!=i)return i}return 0}))},i.prototype.total=function(t,e){return e=e||{},this.totals=this.totals||{},this.totals[t]={reduce:e.reduce||i.aggr.sum,printer:e.printer||h,init:null==e.init?0:e.init},this},i.aggr={},i.aggr.printer=function(t,e){return e=e||o,function(r,n){return h(t+e(r),n)}},i.aggr.sum=function(t,e){return t+e},i.aggr.avg=function(t,e,r,n){return t+=e,r+1==n?t/n:t},i.print=function(t,e,r){var n=e||{};e="function"==typeof e?e:function(t,e){for(var r in t)if(t.hasOwnProperty(r)){var i=n[r]||{};e(i.name||r,t[r],i.printer)}};var o=new i,s=o.cell.bind(o);return Array.isArray(t)?(r=r||function(t){return t.toString()},t.forEach((function(t){e(t,s),o.newRow()}))):(r=r||function(t){return t.printTransposed({separator:" : "})},e(t,s),o.newRow()),r(o)},i.log=function(t,e,r){console.log(i.print(t,e,r))},i.prototype.log=function(){console.log(this.toString())}},653:function(t){t.exports=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531],[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]]},561:function(t,e,r){"use strict";var n=r(451),i=r(653),o={nul:0,control:0};function s(t,e){if("string"!=typeof t)return c(t,e);for(var r=0,n=0;n<t.length;n++){var i=c(t.charCodeAt(n),e);if(i<0)return-1;r+=i}return r}function c(t,e){return 0===t?e.nul:t<32||t>=127&&t<160?e.control:function(t){var e,r=0,n=i.length-1;if(t<i[0][0]||t>i[n][1])return!1;for(;n>=r;)if(e=Math.floor((r+n)/2),t>i[e][1])r=e+1;else{if(!(t<i[e][0]))return!0;n=e-1}return!1}(t)?0:1+(t>=4352&&(t<=4447||9001==t||9002==t||t>=11904&&t<=42191&&12351!=t||t>=44032&&t<=55203||t>=63744&&t<=64255||t>=65040&&t<=65049||t>=65072&&t<=65135||t>=65280&&t<=65376||t>=65504&&t<=65510||t>=131072&&t<=196605||t>=196608&&t<=262141))}t.exports=function(t){return s(t,o)},t.exports.config=function(t){return t=n(t||{},o),function(e){return s(e,t)}}},649:function(t,e,r){"use strict";function n(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}r.d(e,{Z:function(){return n}})}},e={};function r(n){var i=e[n];if(void 0!==i)return i.exports;var o=e[n]={exports:{}};return t[n](o,o.exports,r),o.exports}r.d=function(t,e){for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};return function(){"use strict";r.r(n),r.d(n,{Bin:function(){return u},Box:function(){return c},Packer:function(){return g},heuristics:function(){return t}});var t={};r.r(t),r.d(t,{BestAreaFit:function(){return d},BestLongSideFit:function(){return y},BestShortSideFit:function(){return s},BottomLeft:function(){return b}});var e=r(649);class i{constructor(t,r){(0,e.Z)(this,"score_1",i.MAX_INT),(0,e.Z)(this,"score_2",i.MAX_INT),void 0!==t&&(this.score_1=t),void 0!==r&&(this.score_2=r)}valueOf(){return this.score_1+this.score_2}assign(t){this.score_1=t.score_1,this.score_2=t.score_2}isBlank(){return this.score_1===i.MAX_INT}decreaseBy(t){this.score_1+=t,this.score_2+=t}}(0,e.Z)(i,"MAX_INT",Number.MAX_SAFE_INTEGER);class o{findPositionForNewNode(t,e){let r=new i,n=t.width,o=t.height;return e.forEach((e=>{this.tryPlaceRectIn(e,t,n,o,r),t.constrainRotation||this.tryPlaceRectIn(e,t,o,n,r)})),r}tryPlaceRectIn(t,e,r,n,i){if(t.width>=r&&t.height>=n){let o=this.calculateScore(t,r,n);o<i&&(e.x=t.x,e.y=t.y,e.width=r,e.height=n,e.packed=!0,i.assign(o))}}}class s extends o{calculateScore(t,e,r){let n=[Math.abs(t.width-e),Math.abs(t.height-r)].sort(((t,e)=>t-e));return new i(n[0],n[1])}}class c{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];(0,e.Z)(this,"id",null),(0,e.Z)(this,"width",null),(0,e.Z)(this,"height",null),(0,e.Z)(this,"constrainRotation",!1),(0,e.Z)(this,"x",0),(0,e.Z)(this,"y",0),(0,e.Z)(this,"packed",!1),this.id=t,this.width=r,this.height=n,this.constrainRotation=i}rotate(){let{width:t,height:e}=this;this.width=e,this.height=t}get id(){return this.id}get label(){return"".concat(this.width,"x").concat(this.height," at [").concat(this.x,",").concat(this.y,"]")}get area(){return this.width*this.height}}function h(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function a(t){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?h(Object(n),!0).forEach((function(r){(0,e.Z)(t,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}class u{constructor(t,r,n){(0,e.Z)(this,"width",null),(0,e.Z)(this,"height",null),(0,e.Z)(this,"boxes",[]),(0,e.Z)(this,"heuristic",null),(0,e.Z)(this,"freeRectangles",[]),this.width=t,this.height=r,this.freeRectangles=[new l(t,r)],this.heuristic=n||new s}get area(){return this.width*this.height}get efficiency(){let t=0;return this.boxes.forEach((e=>{t+=e.area})),100*t/this.area}get label(){return"".concat(this.width,"x").concat(this.height," ").concat(this.efficiency,"%")}insert(t){if(t.packed)return!1;if(this.heuristic.findPositionForNewNode(t,this.freeRectangles),!t.packed)return!1;let e=this.freeRectangles.length,r=0;for(;r<e;)this.splitFreeNode(this.freeRectangles[r],t)?(this.freeRectangles.splice(r,1),e--):r++;return this.pruneFreeList(),this.boxes.push(t),!0}scoreFor(t){let e=new c(t.width,t.height,t.constrainRotation);return this.heuristic.findPositionForNewNode(e,this.freeRectangles)}isLargerThan(t){return this.width>=t.width&&this.height>=t.height||this.height>=t.width&&this.width>=t.height}splitFreeNode(t,e){return!(e.x>=t.x+t.width||e.x+e.width<=t.x||e.y>=t.y+t.height||e.y+e.height<=t.y||(this.trySplitFreeNodeVertically(t,e),this.trySplitFreeNodeHorizontally(t,e),0))}trySplitFreeNodeVertically(t,e){e.x<t.x+t.width&&e.x+e.width>t.x&&(this.tryLeaveFreeSpaceAtTop(t,e),this.tryLeaveFreeSpaceAtBottom(t,e))}tryLeaveFreeSpaceAtTop(t,e){if(e.y>t.y&&e.y<t.y+t.height){let r=a({},t);r.height=e.y-r.y,this.freeRectangles.push(r)}}tryLeaveFreeSpaceAtBottom(t,e){if(e.y+e.height<t.y+t.height){let r=a({},t);r.y=e.y+e.height,r.height=t.y+t.height-(e.y+e.height),this.freeRectangles.push(r)}}trySplitFreeNodeHorizontally(t,e){e.y<t.y+t.height&&e.y+e.height>t.y&&(this.tryLeaveFreeSpaceOnLeft(t,e),this.tryLeaveFreeSpaceOnRight(t,e))}tryLeaveFreeSpaceOnLeft(t,e){if(e.x>t.x&&e.x<t.x+t.width){let r=a({},t);r.width=e.x-r.x,this.freeRectangles.push(r)}}tryLeaveFreeSpaceOnRight(t,e){if(e.x+e.width<t.x+t.width){let r=a({},t);r.x=e.x+e.width,r.width=t.x+t.width-(e.x+e.width),this.freeRectangles.push(r)}}pruneFreeList(){let t=0;for(;t<this.freeRectangles.length;){let e=t+1;if(e===this.freeRectangles.length)break;for(;e<this.freeRectangles.length;){if(this.isContainedIn(this.freeRectangles[t],this.freeRectangles[e])){this.freeRectangles.splice(t,1),t--;break}this.isContainedIn(this.freeRectangles[e],this.freeRectangles[t])?this.freeRectangles.splice(e,1):e++}t++}}isContainedIn(t,e){return t&&e&&t.x>=e.x&&t.y>=e.y&&t.x+t.width<=e.x+e.width&&t.y+t.height<=e.y+e.height}}class l{constructor(t,r){(0,e.Z)(this,"x",0),(0,e.Z)(this,"y",0),(0,e.Z)(this,"width",null),(0,e.Z)(this,"height",null),this.width=t,this.height=r}}class f{constructor(t,r){(0,e.Z)(this,"bin",null),(0,e.Z)(this,"box",null),(0,e.Z)(this,"score",null),this.bin=t,this.box=r}calculate(){return this.score=this.bin.scoreFor(this.box),this.score}fit(){return!this.score.isBlank()}}class p{constructor(t,r){(0,e.Z)(this,"entries",[]),t.forEach((t=>{this.addBinEntries(t,r)}))}debug(){r(426),console.table(this.entries.map((t=>({bin:t.bin.label,box_id:t.box.id,box:t.box.label,packed:t.box.packed,score:t.score}))))}addBinEntries(t,e){e.forEach((e=>{let r=new f(t,e);r.calculate(),this.entries.push(r)}))}any(){return this.boxes.some((t=>t))}largestNotFitingBox(){return this.entries.filter((t=>t.fit)).map((t=>t.box)),this.entries.forEach((t=>{this.fittingBoxes.contains(t.box)&&(this.unfit=t)})),!!null.box&&null}bestFit(){let t=null;for(let e=0;e<this.entries.length;e++){let r=this.entries[e];r.fit()&&(null===t||r.score<t.score)&&(t=r)}return t}removeBox(t){this.entries=this.entries.filter((e=>e.box!==t))}addBin(t){this.addBinEntries(t,this.currentBoxes())}recalculateBin(t){this.entries.filter((e=>e.bin===t)).forEach((t=>t.calculate()))}currentBoxes(){return[...new Set(this.entries.map((t=>t.box)))]}}class g{constructor(t){(0,e.Z)(this,"bins",[]),(0,e.Z)(this,"unpackedBoxes",[]),this.bins=t}pack(t){let e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=[];if(0===(t=t.filter((t=>!t.packed))).length)return n;let o=r.limit||i.MAX_INT,s=new p(this.bins,t);for(;(e=s.bestFit())&&(e.bin.insert(e.box),s.removeBox(e.box),s.recalculateBin(e.bin),n.push(e.box),!(n.length>=o)););return this.unpackedBoxes=t.filter((t=>!t.packed)),console.log("packedBoxes: "+JSON.stringify(n,null,4)),n}}class d extends o{calculateScore(t,e,r){let n=t.width*t.height-e*r,o=Math.abs(t.width-e),s=Math.abs(t.height-r),c=Math.min(o,s);return new i(n,c)}}class y extends o{calculateScore(t,e,r){let n=[Math.abs(t.width-e),Math.abs(t.height-r)].sort(((t,e)=>t-e)).reverse();return new i(n[0],n[1])}}class b extends o{calculateScore(t,e,r){let n=t.y+r;return new i(n,t.x)}}}(),n}()}));